benchmark: STIG
id: "V-230265"
title: "The operating system must configure kernel parameters to enable SYN cookies."
severity: high
original_severity: "CAT II"
os_compatibility:
  - ubuntu: "18.04+"
rationale: "SYN cookies help protect against SYN flood attacks by using cryptographic cookies."
check:
  type: sysctl
  command: "sysctl net.ipv4.tcp_syncookies"
  expected_state: "1"
remediation:
  commands:
    - "cat >> /etc/sysctl.d/99-security.conf << 'EOF'\n# Enable TCP/IP SYN cookies\nnet.ipv4.tcp_syncookies = 1\nEOF"
    - "sysctl -p /etc/sysctl.d/99-security.conf"
  requires_restart: false
  requires_reboot: false
rollback:
  commands:
    - "sed -i '/net.ipv4.tcp_syncookies/d' /etc/sysctl.d/99-security.conf"
    - "sysctl -w net.ipv4.tcp_syncookies=0"
ai_assist: false
approval_required: true
exception_allowed: true
