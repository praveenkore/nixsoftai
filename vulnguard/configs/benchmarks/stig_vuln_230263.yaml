benchmark: STIG
id: "V-230263"
title: "The operating system must configure kernel parameters to protect against symlink attacks."
severity: high
original_severity: "CAT II"
os_compatibility:
  - ubuntu: "18.04+"
rationale: "Protected symlinks and hardlinks prevent TOCTOU (Time-of-check to Time-of-use) attacks."
check:
  type: sysctl
  command: "sysctl fs.protected_symlinks"
  expected_state: "1"
remediation:
  commands:
    - "cat >> /etc/sysctl.d/99-security.conf << 'EOF'\n# Protect symlinks and hardlinks\nfs.protected_symlinks = 1\nfs.protected_hardlinks = 1\nEOF"
    - "sysctl -p /etc/sysctl.d/99-security.conf"
  requires_restart: false
  requires_reboot: false
rollback:
  commands:
    - "sed -i '/fs.protected_symlinks/d' /etc/sysctl.d/99-security.conf"
    - "sed -i '/fs.protected_hardlinks/d' /etc/sysctl.d/99-security.conf"
    - "sysctl -w fs.protected_symlinks=0"
    - "sysctl -w fs.protected_hardlinks=0"
ai_assist: false
approval_required: true
exception_allowed: true
